CREATE TABLE app (ID INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), documentRoot VARCHAR(255), loadBalanceAcrossServers BOOLEAN, name VARCHAR(255) NOT NULL, secure BOOLEAN, unpackWar BOOLEAN, warName VARCHAR(255), warPath VARCHAR(255), webAppContext VARCHAR(255) NOT NULL, GROUP_ID BIGINT, CONSTRAINT U_APP_NAME UNIQUE (name));
CREATE TABLE APP_CONFIG_TEMPLATE (ID INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), locked BOOLEAN, metaData VARCHAR(2147483647) NOT NULL, TEMPLATE_CONTENT VARCHAR(2147483647) NOT NULL, TEMPLATE_NAME VARCHAR(255) NOT NULL, APP_ID BIGINT, JVM_ID BIGINT, CONSTRAINT U_PP_CPLT_APP_ID UNIQUE (APP_ID, TEMPLATE_NAME, JVM_ID));
CREATE TABLE grp (ID INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), name VARCHAR(255) NOT NULL, STATE VARCHAR(255), stateUpdated TIMESTAMP, CONSTRAINT U_GRP_NAME UNIQUE (name));
CREATE TABLE GRP_APP_CONFIG_TEMPLATE (ID INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), locked BOOLEAN, metaData VARCHAR(2147483647) NOT NULL, TEMPLATE_CONTENT VARCHAR(2147483647) NOT NULL, TEMPLATE_NAME VARCHAR(255) NOT NULL, APP_ID BIGINT, GRP_ID BIGINT, CONSTRAINT U_GRP_PLT_GRP_ID2 UNIQUE (GRP_ID, TEMPLATE_NAME));
CREATE TABLE GRP_JVM (GROUP_ID BIGINT, JVM_ID BIGINT, CONSTRAINT U_GRP_JVM_GROUP_ID UNIQUE (GROUP_ID, JVM_ID));
CREATE TABLE GRP_JVM_CONFIG_TEMPLATE (ID INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), locked BOOLEAN, metaData VARCHAR(2147483647) NOT NULL, TEMPLATE_CONTENT VARCHAR(2147483647) NOT NULL, TEMPLATE_NAME VARCHAR(255) NOT NULL, GRP_ID BIGINT, CONSTRAINT U_GRP_PLT_GRP_ID UNIQUE (GRP_ID, TEMPLATE_NAME));
CREATE TABLE GRP_WEBSERVER_CONFIG_TEMPLATE (ID INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), locked BOOLEAN, metaData VARCHAR(2147483647) NOT NULL, TEMPLATE_CONTENT VARCHAR(2147483647) NOT NULL, TEMPLATE_NAME VARCHAR(255) NOT NULL, GRP_ID BIGINT, CONSTRAINT U_GRP_PLT_GRP_ID1 UNIQUE (GRP_ID, TEMPLATE_NAME));
CREATE TABLE history (id INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), event VARCHAR(10000), EVENTTYPE VARCHAR(2), serverName VARCHAR(255) NOT NULL, groupId BIGINT, CONSTRAINT U_HISTORY_ID UNIQUE (id));
CREATE TABLE jvm (id INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), ajpPort INTEGER NOT NULL, encryptedPassword VARCHAR(255), ERR_STS VARCHAR(2147483647), hostName VARCHAR(255), httpPort INTEGER NOT NULL, httpsPort INTEGER, name VARCHAR(255) NOT NULL, redirectPort INTEGER NOT NULL, shutdownPort INTEGER NOT NULL, state VARCHAR(20), statusPath VARCHAR(255) NOT NULL, systemProperties VARCHAR(255), userName VARCHAR(255), CONSTRAINT U_JVM_NAME UNIQUE (name));
CREATE TABLE JVM_CONFIG_TEMPLATE (ID INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), locked BOOLEAN, metaData VARCHAR(2147483647) NOT NULL, TEMPLATE_CONTENT VARCHAR(2147483647) NOT NULL, TEMPLATE_NAME VARCHAR(255) NOT NULL, JVM_ID BIGINT, CONSTRAINT U_JVM_PLT_JVM_ID UNIQUE (JVM_ID, TEMPLATE_NAME));
CREATE TABLE RESOURCE_CONFIG_TEMPLATE (ID INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), locked BOOLEAN, metaData VARCHAR(2147483647) NOT NULL, TEMPLATE_CONTENT VARCHAR(2147483647) NOT NULL, TEMPLATE_NAME VARCHAR(255) NOT NULL, APP_ID BIGINT, ENTITY_ID BIGINT, ENTITY_TYPE SMALLINT, GRP_ID BIGINT, CONSTRAINT U_RSRCPLT_ENTITY_ID UNIQUE (ENTITY_ID, APP_ID, GRP_ID, ENTITY_TYPE, TEMPLATE_NAME));
CREATE TABLE webserver (id INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), docRoot VARCHAR(255) NOT NULL, ERR_STS VARCHAR(2147483647), host VARCHAR(255), httpConfigFile VARCHAR(255) NOT NULL, httpsPort INTEGER, name VARCHAR(255), port INTEGER, state VARCHAR(20), statusPath VARCHAR(255) NOT NULL, svrRoot VARCHAR(255) NOT NULL, CONSTRAINT U_WBSRVER_NAME UNIQUE (name));
CREATE TABLE WEBSERVER_CONFIG_TEMPLATE (ID INTEGER NOT NULL IDENTITY, createBy VARCHAR(255), createDate TIMESTAMP, lastUpdateDate TIMESTAMP, updateBy VARCHAR(255), locked BOOLEAN, metaData VARCHAR(2147483647) NOT NULL, TEMPLATE_CONTENT VARCHAR(2147483647) NOT NULL, TEMPLATE_NAME VARCHAR(255) NOT NULL, WEBSERVER_ID BIGINT, CONSTRAINT U_WBSRPLT_WEBSERVER_ID UNIQUE (WEBSERVER_ID, TEMPLATE_NAME));
CREATE TABLE WEBSERVER_GRP (GROUP_ID BIGINT, WEBSERVER_ID BIGINT, CONSTRAINT U_WBSRGRP_GROUP_ID UNIQUE (GROUP_ID, WEBSERVER_ID));
ALTER TABLE app ADD FOREIGN KEY (GROUP_ID) REFERENCES grp (ID);
ALTER TABLE APP_CONFIG_TEMPLATE ADD FOREIGN KEY (APP_ID) REFERENCES app (ID) ON DELETE CASCADE;
ALTER TABLE APP_CONFIG_TEMPLATE ADD FOREIGN KEY (JVM_ID) REFERENCES jvm (id) ON DELETE CASCADE;
ALTER TABLE GRP_APP_CONFIG_TEMPLATE ADD FOREIGN KEY (APP_ID) REFERENCES app (ID) ON DELETE CASCADE;
ALTER TABLE GRP_APP_CONFIG_TEMPLATE ADD FOREIGN KEY (GRP_ID) REFERENCES grp (ID) ON DELETE CASCADE;
ALTER TABLE GRP_JVM ADD FOREIGN KEY (GROUP_ID) REFERENCES grp (ID);
ALTER TABLE GRP_JVM ADD FOREIGN KEY (JVM_ID) REFERENCES jvm (id);
ALTER TABLE GRP_JVM_CONFIG_TEMPLATE ADD FOREIGN KEY (GRP_ID) REFERENCES grp (ID) ON DELETE CASCADE;
ALTER TABLE GRP_WEBSERVER_CONFIG_TEMPLATE ADD FOREIGN KEY (GRP_ID) REFERENCES grp (ID) ON DELETE CASCADE;
ALTER TABLE history ADD FOREIGN KEY (groupId) REFERENCES grp (ID);
ALTER TABLE JVM_CONFIG_TEMPLATE ADD FOREIGN KEY (JVM_ID) REFERENCES jvm (id) ON DELETE CASCADE;
ALTER TABLE WEBSERVER_CONFIG_TEMPLATE ADD FOREIGN KEY (WEBSERVER_ID) REFERENCES webserver (id) ON DELETE CASCADE;
ALTER TABLE WEBSERVER_GRP ADD FOREIGN KEY (GROUP_ID) REFERENCES grp (ID);
ALTER TABLE WEBSERVER_GRP ADD FOREIGN KEY (WEBSERVER_ID) REFERENCES webserver (id);
CREATE TABLE IF NOT EXISTS VERSION (RELEASE_VERSION VARCHAR(255), LAST_UPDATED TIMESTAMP);
INSERT INTO VERSION (RELEASE_VERSION, LAST_UPDATED) VALUES ('1.3.89.8', NOW());